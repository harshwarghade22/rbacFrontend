<app-navbar></app-navbar>


<div class="page-wrapper">
    <!-- Page Header -->
    <div class="page-header">
        <div class="header-left">
            <div class="header-title-row">
                <div class="header-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="1" x2="12" y2="23" />
                        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                    </svg>
                </div>
                <div>
                    <h1 class="page-title">Account Transactions</h1>
                    <p class="page-subtitle">View and manage all transaction records</p>
                </div>
            </div>
        </div>
        <div class="header-right">
            <button class="export-btn" (click)="exportExcel()" [disabled]="exporting" [class.exporting]="exporting">
                <svg *ngIf="!exporting" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
                    <polyline points="7 10 12 15 17 10" />
                    <line x1="12" y1="15" x2="12" y2="3" />
                </svg>
                <svg *ngIf="exporting" class="spinner" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="2" x2="12" y2="6" />
                    <line x1="12" y1="18" x2="12" y2="22" />
                    <line x1="4.93" y1="4.93" x2="7.76" y2="7.76" />
                    <line x1="16.24" y1="16.24" x2="19.07" y2="19.07" />
                    <line x1="2" y1="12" x2="6" y2="12" />
                    <line x1="18" y1="12" x2="22" y2="12" />
                    <line x1="4.93" y1="19.07" x2="7.76" y2="16.24" />
                    <line x1="16.24" y1="7.76" x2="19.07" y2="4.93" />
                </svg>
                {{ exporting ? 'Exporting...' : 'Export Excel' }}
            </button>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="stats-row">
        <div class="stat-card">
            <div class="stat-icon blue">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
                    <line x1="1" y1="10" x2="23" y2="10" />
                </svg>
            </div>
            <div class="stat-info">
                <span class="stat-label">Account ID</span>
                <span class="stat-value">{{ accountId }}</span>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon green">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18" />
                    <polyline points="17 6 23 6 23 12" />
                </svg>
            </div>
            <!-- <div class="stat-info">
                <span class="stat-label">Total Transactions</span>
                <span class="stat-value">{{ totalElements }}</span>
            </div> -->
        </div>

        <div class="stat-card">
            <div class="stat-icon purple">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                    <line x1="16" y1="2" x2="16" y2="6" />
                    <line x1="8" y1="2" x2="8" y2="6" />
                    <line x1="3" y1="10" x2="21" y2="10" />
                </svg>
            </div>
            <div class="stat-info">
                <span class="stat-label">Current Page</span>
                <span class="stat-value">{{ page + 1 }} of {{ totalPages }}</span>
            </div>
        </div>

        <div class="stat-card">
            <div class="stat-icon orange">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                    <polyline points="14 2 14 8 20 8" />
                    <line x1="16" y1="13" x2="8" y2="13" />
                    <line x1="16" y1="17" x2="8" y2="17" />
                </svg>
            </div>
            <div class="stat-info">
                <span class="stat-label">Page Size</span>
                <span class="stat-value">{{ pageSize }} records</span>
            </div>
        </div>
    </div>

    <!-- Table Card -->
    <div class="table-card">
        <!-- Table Toolbar -->
        <div class="table-toolbar">
            <div class="toolbar-left">
                <h3 class="table-title">Transaction Records</h3>
                <span class="record-count">{{ transactions.length }} records shown</span>
            </div>
            <div class="toolbar-right">
                <div class="page-size-selector">
                    <label for="pageSize">Show</label>
                    <select id="pageSize" [(ngModel)]="pageSize" (change)="onPageSizeChange($event)">
                        <option *ngFor="let size of pageSizeOptions" [value]="size">
                            {{ size }}
                        </option>
                    </select>
                    <label>entries</label>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div class="loading-state" *ngIf="loading">
            <div class="loading-spinner"></div>
            <p>Loading transactions...</p>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="!loading && transactions.length === 0">
            <div class="empty-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="12" y1="8" x2="12" y2="12" />
                    <line x1="12" y1="16" x2="12.01" y2="16" />
                </svg>
            </div>
            <h3>No Transactions Found</h3>
            <p>There are no transaction records for this account yet.</p>
        </div>

        <!-- Table -->
        <div class="table-wrapper" *ngIf="!loading && transactions.length > 0">
            <table>
                <thead>
                    <tr>
                        <th>
                            <div class="th-content">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <line x1="12" y1="1" x2="12" y2="23" />
                                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
                                </svg>
                                Amount
                            </div>
                        </th>
                        <th>
                            <div class="th-content">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <polyline points="17 1 21 5 17 9" />
                                    <path d="M3 11V9a4 4 0 0 1 4-4h14" />
                                    <polyline points="7 23 3 19 7 15" />
                                    <path d="M21 13v2a4 4 0 0 1-4 4H3" />
                                </svg>
                                Type
                            </div>
                        </th>
                        <th>
                            <div class="th-content">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10" />
                                    <polyline points="12 6 12 12 16 14" />
                                </svg>
                                Timestamp
                            </div>
                        </th>
                        <th>
                            <div class="th-content">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round">
                                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2" />
                                    <line x1="1" y1="10" x2="23" y2="10" />
                                </svg>
                                Account Number
                            </div>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let tx of transactions; let i = index" [class.even]="i % 2 === 0">
                        <td>
                            <span class="amount" [class.credit]="tx.type === 'CREDIT'"
                                [class.debit]="tx.type === 'DEBIT'">
                                <span class="amount-symbol">₹</span>
                                {{ tx.amount | number:'1.2-2' }}
                            </span>
                        </td>
                        <td>
                            <span class="type-badge" [class.credit-badge]="tx.type === 'CREDIT'"
                                [class.debit-badge]="tx.type === 'DEBIT'"
                                [class.transfer-badge]="tx.type === 'TRANSFER'">
                                <span class="badge-dot"></span>
                                {{ tx.type }}
                            </span>
                        </td>
                        <td>
                            <span class="timestamp">{{ tx.timestamp | date:'MMM dd, yyyy • hh:mm a' }}</span>
                        </td>
                        <td>
                            <span class="account-number">{{ tx.accountNumber }}</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div class="pagination" *ngIf="!loading && totalPages > 1">
            <!-- <div class="pagination-info">
                Showing <strong>{{ page * pageSize + 1 }}</strong> to
                <strong>{{ getEndRecord() }}</strong> of
                <strong>{{ totalElements }}</strong> entries
            </div> -->
            <div class="pagination-controls">
                <button class="page-btn" (click)="goToFirst()" [disabled]="page === 0" title="First Page">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="11 17 6 12 11 7" />
                        <polyline points="18 17 13 12 18 7" />
                    </svg>
                </button>
                <button class="page-btn" (click)="prevPage()" [disabled]="page === 0" title="Previous Page">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="15 18 9 12 15 6" />
                    </svg>
                </button>

                <ng-container *ngFor="let p of getPageNumbers()">
                    <button class="page-btn page-number" [class.active]="p === page" (click)="goToPage(p)">
                        {{ p + 1 }}
                    </button>
                </ng-container>

                <button class="page-btn" (click)="nextPage()" [disabled]="page >= totalPages - 1" title="Next Page">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="9 18 15 12 9 6" />
                    </svg>
                </button>
                <button class="page-btn" (click)="goToLast()" [disabled]="page >= totalPages - 1" title="Last Page">
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="13 17 18 12 13 7" />
                        <polyline points="6 17 11 12 6 7" />
                    </svg>
                </button>
            </div>
        </div>
    </div>
</div>